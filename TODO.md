
# TODO list for Qwy3

## Performance

- Generate textures in an other thread (share the atlas) because it takes too long at the beginning and it is noticeable and annoying.
- Measure time taken by chunk management alone and make it better (stuff like deciding which chunk to mesh or generate is so bad currently that it is easy to speed up). 
- Ray casting by player to target a block is neither correct nor performant, do it right. 

## Graphics

- Cascading shadow mapping. Currently there is a single shadow map, but there should be multiple shadow maps corresponding to bigger and bigger areas so that shadows can be rendered even for far away stuff but without using as much resolution as for shadows close to the player.
- Skybox (procedurally generated, maybe in the style of ouput 20 of noizebra).
  - Make the terrain fade out into the skybox when far enough. Instead of a fog effect that makes the terrain get more and more painted in some plain color as it gets far, it should instead get more and more transparent to let the skybox show.
- Sun. It could look like a 4-branch star in the style of star effects in Kill la Kill.
- God rays effect when looking at sun. I recall it can be done by rendering just the sun in white and all the world in black and doing some motion blur on the result, maybe?
- Glow effect.

## UI

- Maybe introduce type aliases to better label weather we are after or before the correction by `2.0/window_with`.

## Controls

- Add controler support.

## Binary command line interface

- Allow to provide qwy script commands at binary invocation time that are to be executed during loading or after the first frame or something.

## Command Language

- Add commands to interface with the game.
- Add strings.
- Add a logging function.
- Add a way to define new typed global variables.
- Add a way to set variables.
- Add floating point numbers.

## World

- Procedurally generated types of block.
  - Procedurally generated textures for these types of blocks.
  - Procedurally generated properties.
- Generation of (procedurally generated types of) structures.
  - Structure types are procedurally generated (meaning that a type of tree found in a world will not be found in other worlds).
    - This can be done by making the structure type be an algorithm that can be procedurally generated (it is just a tree).
  - Foactorize ot of the world generators that uses structures the structure generation "engine"! And make it actually readable.

## Mechanics and Gameplay

- Collision physics. The player box should not be able to overlap with non-pass-through blocks, but should be able to slide on walls and walk on the floor and stuff. Beware, this is way more difficult to implement in a sane way than it looks.
- Entities!!
  - Particles, like when breaking blocks.
  - Falling blocks.
  - Animals >w< or something.
- Liquids!!
  - Pools of liquid, keeping track of the volume of the pool, all the block coordinates that has some of it, the height of the liquid (z-coord of its surface), etc.
  - Handle the case when a pool of liquid has to flow due to a hole in a neighboring block.
  - Handle gigantic pools of liquid (like a sea or an ocean) that cannot be generated all at once and all and that we can safely consider to contain an infinite amount of liquid.
- Magic system!!
  - Runes, typing runes, casting.
  - Procedural grammar and mapping of elementary spells to their effects.
    - Make sure there are plenty of effects thta can be generated procedurally in the elementary spell map.
  - Mana.
  - Etc. (magic circles, engraving runes on blocks, etc.)
- "Survival" game mode with health and limitations and stuff. 
  - Can only carry one block at a time. Once a block is broken it falls and can be picked up without any tool. Breaking a block doesn't take any time. 
  - Respawns from eggs. Eggs are generated by the world gen.
  - Organ tree in each animal (player included). 
- Gods. 
  - Through some mechanic (to be decided, like a command or a spell or finding a temple or an altar or building an altar or performing some ritual or something), the player can pray to one god among a pool of possible gods. 
  - Praying to a god grants a divine blessing that depends on the god, like more jumps or flying, infinite or more mana, always being able to see owns organ tree, some other abilities, etc. 
  - Divine blessings come at some cost that depends on the god too, like some bosses that are summoned later to challenge you. 
  - Can pray to multiple gods, the effects can stack.

## Saves and multiplayer

- Save chunk data to disk when unloading.
- Multiplayer. Allow the game to become a client or a server.
  - Use something like https://github.com/TimonPost/laminar to send chunk data from the server to clients (it allows for reliable but unordered channels that seem fast (but still reliable!)!).

## Other

- Profile (maybe with https://github.com/killercup/cargo-flamegraph or something else).
- Profile but with https://github.com/plasma-umass/coz maybe?
- Reduce the length of `lib.rs` and the `run` function!
- More info in the README, like control bindings syntax, default controls, command line arguments, etc.
